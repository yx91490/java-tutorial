(window.webpackJsonp=window.webpackJsonp||[]).push([[79],{518:function(a,t,s){"use strict";s.r(t);var n=s(27),e=Object(n.a)({},(function(){var a=this,t=a.$createElement,s=a._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"旧版日期时间代码"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#旧版日期时间代码"}},[a._v("#")]),a._v(" 旧版日期时间代码")]),a._v(" "),s("p",[a._v("可以说是旧版日期机制的代码迁移指南吧")]),a._v(" "),s("p",[a._v("在 Java SE 8 发布前，java 提供了日期时间机制的类 java.util.Date， java.util.Calendar\n以及 java.util.TimeZone 类，以及它们的子类，如 java.util.GregorianCalendar 中。这些类有几个缺点，包括：")]),a._v(" "),s("ul",[s("li",[a._v("Calendar 是不安全的")]),a._v(" "),s("li",[a._v("由于这些类是可变的，因此他们不能用于多线程")]),a._v(" "),s("li",[a._v("应用程序代码中的错误是常见的，原因是不寻常的几个月和缺乏类型安全。?")])]),a._v(" "),s("h2",{attrs:{id:"与遗留代码的互操作性"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#与遗留代码的互操作性"}},[a._v("#")]),a._v(" 与遗留代码的互操作性")]),a._v(" "),s("p",[a._v("也序你使用了 java.util 的日期相关的类，并且想对现有代码进行最小改动的情况下使用 java.time 的功能")]),a._v(" "),s("p",[a._v("JDK8 提供了几个方法允许 java.util 和 java.time 对象之间进行转换：")]),a._v(" "),s("ul",[s("li",[a._v("Calendar.toInstant()")]),a._v(" "),s("li",[a._v("GregorianCalendar.toZonedDateTime()")]),a._v(" "),s("li",[a._v("GregorianCalendar.from(ZonedDateTime)")]),a._v(" "),s("li",[a._v("Date.from(Instant)")]),a._v(" "),s("li",[a._v("Date.toInstant()")]),a._v(" "),s("li",[a._v("TimeZone.toZoneId()")])]),a._v(" "),s("p",[a._v("以下示例将 Calendar 实例转换为 ZonedDateTime 实例。请注意，必须提供时区才能将 Instant 转换为 ZonedDateTime：")]),a._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Calendar")]),a._v(" now "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Calendar")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("getInstance")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("ZonedDateTime")]),a._v(" zdt "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("ZonedDateTime")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("ofInstant")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("now"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("toInstant")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("ZoneId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("systemDefault")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("p",[a._v("以下示例 Date 和 Instant 之间的转换")]),a._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Instant")]),a._v(" inst "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" date"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("toInstant")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Date")]),a._v(" newDate "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Date")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("from")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("inst"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br")])]),s("p",[a._v("以下示例将从 GregorianCalendar 转换为 ZonedDateTime，然后从 ZonedDateTime 转换为 GregorianCalendar。\n其他基于时间的类是使用 ZonedDateTime 实例创建的：")]),a._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("GregorianCalendar")]),a._v(" cal "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("new")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("GregorianCalendar")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("TimeZone")]),a._v(" tz "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" cal"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("getTimeZone")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("int")]),a._v(" tzoffset "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" cal"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Calendar")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("ZONE_OFFSET"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// 获取偏移量")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("ZonedDateTime")]),a._v(" zdt "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" cal"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("toZonedDateTime")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("GregorianCalendar")]),a._v(" newCal "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("GregorianCalendar")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("from")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("zdt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("LocalDateTime")]),a._v(" ldt "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" zdt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("toLocalDateTime")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("LocalDate")]),a._v(" date "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" zdt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("toLocalDate")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("LocalTime")]),a._v(" time "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" zdt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("toLocalTime")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br")])]),s("h2",{attrs:{id:"java-util-date-与-java-time-功能映射"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#java-util-date-与-java-time-功能映射"}},[a._v("#")]),a._v(" java.util Date 与 java.time 功能映射")]),a._v(" "),s("p",[a._v("因为 Java SE 8 版本中已经完全重新设计了日期和时间的 Java 实现，所以您不能将一个方法替换为另一个方法。\n如果您想要使用 java 提供的丰富功能。时间包，您最简单的解决方案是使用上一节中列出的 toInstant 或 toZonedDateTime 方法。\n但是，如果您不想使用这种方法，或者它对您的需求来说是不够的，那么您必须重写您的日期时间代码。")]),a._v(" "),s("p",[a._v("在 "),s("RouterLink",{attrs:{to:"/datetime/iso/overview.html"}},[a._v("概述")]),a._v(" 页面中的表格可以让你明白哪些类是复合你的需求的")],1),a._v(" "),s("p",[a._v("这两个 api 之间没有一对一的映射对应关系，但是下面列出了 大致功能概念的映射")]),a._v(" "),s("h3",{attrs:{id:"java-util-date-与-java-timeinstant"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#java-util-date-与-java-timeinstant"}},[a._v("#")]),a._v(" java.util.Date 与 java.timeInstant")]),a._v(" "),s("p",[a._v("这两个类是相似的：")]),a._v(" "),s("ul",[s("li",[a._v("代表时间轴(UTC)上的瞬时点")]),a._v(" "),s("li",[a._v("保存一个与时区无关的时间")]),a._v(" "),s("li",[a._v("表示的是纳秒 epoch-seconds(自 1970-01-01T00:00:00Z 起)")])]),a._v(" "),s("p",[s("code",[a._v("Date.from(Instant)")]),a._v(" 和 "),s("code",[a._v("Date.toInstant()")]),a._v(" 方法互相转换")]),a._v(" "),s("h3",{attrs:{id:"java-util-gregoriancalendar-和-java-time-zoneddatetime"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#java-util-gregoriancalendar-和-java-time-zoneddatetime"}},[a._v("#")]),a._v(" java.util.GregorianCalendar 和 java.time.ZonedDateTime")]),a._v(" "),s("p",[a._v("ZonedDateTime 类是替代 GregorianCalendar 的 。它提供了以下类似的功能。")]),a._v(" "),s("p",[a._v("人类时间")]),a._v(" "),s("ul",[s("li",[a._v("LocalDate: 年，月，日")]),a._v(" "),s("li",[a._v("LocalTime: 时，分，秒，纳秒")]),a._v(" "),s("li",[a._v("ZoneId: 时区")]),a._v(" "),s("li",[a._v("ZoneOffset: 从 GMT 的偏移量")])]),a._v(" "),s("p",[s("code",[a._v("GregorianCalendar.from(ZonedDateTime)")]),a._v(" 和 "),s("code",[a._v("GregorianCalendar.to(ZonedDateTime)")]),a._v(" 相互转换")]),a._v(" "),s("h3",{attrs:{id:"java-util-timezone-和-java-time-zoneid-zoneoffset"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#java-util-timezone-和-java-time-zoneid-zoneoffset"}},[a._v("#")]),a._v(" java.util.TimeZone 和 java.time.ZoneId/ZoneOffset")]),a._v(" "),s("ul",[s("li",[a._v("ZoneId 指定时区标识符和访问所使用的每个时区的规则")]),a._v(" "),s("li",[a._v("ZoneOffset 指定一个从格林尼治/ UTC 偏移。有关更多信息，请参阅 "),s("RouterLink",{attrs:{to:"/datetime/iso/timezones.html"}},[a._v("时区和偏移")]),a._v(" 类。")],1)]),a._v(" "),s("h3",{attrs:{id:"gregoriancalendar-和-java-time-localtime"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#gregoriancalendar-和-java-time-localtime"}},[a._v("#")]),a._v(" GregorianCalendar 和 java.time.LocalTime")]),a._v(" "),s("p",[a._v("在 GregorianCalendar 实例中将日期设置为 1970-01-01 以便使用时间组件的代码可以替换为 LocalTime 实例。 因为 LocalTime 只包含时分秒")]),a._v(" "),s("h3",{attrs:{id:"gregoriancalendar-和-java-time-localdate"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#gregoriancalendar-和-java-time-localdate"}},[a._v("#")]),a._v(" GregorianCalendar 和 java.time.LocalDate")]),a._v(" "),s("p",[a._v("在 GregorianCalendar 实例中将时间设置为 00:00 以便使用日期组件的代码可以用 LocalDate 的实例替换。\n（这样的方法有缺陷，因为在一些国家，由于过渡到夏令时，每年午夜都不会发生。）")]),a._v(" "),s("h2",{attrs:{id:"日期和时间格式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#日期和时间格式"}},[a._v("#")]),a._v(" 日期和时间格式")]),a._v(" "),s("p",[a._v("尽管 java.time.format.DateTimeFormatter 为格式化日期和时间值提供了强大的机制，但您也可以直接使用\njava.util.Formatter 和 String.format 来格式化 java.time 类")])])}),[],!1,null,null,null);t.default=e.exports}}]);